<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PySpice.Spice.NgSpice.Shared &#8212; PySpice 0.3.0 documentation</title>
    
    <link rel="stylesheet" href="../../../../static/PySpice.css" type="text/css" />
    <link rel="stylesheet" href="../../../../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../../static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../../static/hidecode.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">PySpice 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../Spice.html" accesskey="U">PySpice.Spice</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for PySpice.Spice.NgSpice.Shared</h1><div class="highlight"><pre>
<span></span><span class="c1">####################################################################################################</span>
<span class="c1">#</span>
<span class="c1"># PySpice - A Spice Package for Python</span>
<span class="c1"># Copyright (C) 2014 Fabrice Salvaire</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1">####################################################################################################</span>

<span class="sd">&quot;&quot;&quot;This module provides a Python interface to the Ngspice shared library described in the *ngspice</span>
<span class="sd">as shared library or dynamic link library* section of the Ngspice user manual.</span>

<span class="sd">In comparison to the subprocess interface, it provides an interaction with the simulator through</span>
<span class="sd">commands and callbacks and it enables the usage of external voltage and current source in the</span>
<span class="sd">circuit.</span>

<span class="sd">.. This approach corresponds to the *standard way* to make an interface to a simulator code.</span>

<span class="sd">.. warning:: Since we don&#39;t simulate a circuit in a fresh environment on demand, this approach is</span>
<span class="sd"> less safe than the subprocess approach. In case of bugs within Ngspice, we can expect some side</span>
<span class="sd"> effects like memory leaks or worse unexpected things.</span>

<span class="sd">This interface use the CFFI module to interface with the shared library. It is thus suited to run</span>
<span class="sd">within the Pypy interpreter which implements JIT optimisation for Python.</span>

<span class="sd">It can also be used to experiment parallel simulation as explained in the Ngspice user manual. But</span>
<span class="sd">it seems the Ngspice source code was designed with global variables which imply to use one copy of</span>
<span class="sd">the shared library by worker as explained in the manual.</span>

<span class="sd">.. warning:: This interface can strongly slow down the simulation if the input or output callbacks</span>
<span class="sd">  is used.  If the simulation time goes wrong for you then you need to implement the callbacks at a</span>
<span class="sd">  lower level than Python. You can have look to Pypy, Cython or a C extension module.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">####################################################################################################</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">####################################################################################################</span>

<span class="kn">from</span> <span class="nn">cffi</span> <span class="k">import</span> <span class="n">FFI</span>
<span class="n">ffi</span> <span class="o">=</span> <span class="n">FFI</span><span class="p">()</span>

<span class="c1">####################################################################################################</span>

<span class="n">_module_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1">####################################################################################################</span>

<span class="kn">from</span> <span class="nn">PySpice.Probe.WaveForm</span> <span class="k">import</span> <span class="p">(</span><span class="n">OperatingPoint</span><span class="p">,</span> <span class="n">SensitivityAnalysis</span><span class="p">,</span>
                                    <span class="n">DcAnalysis</span><span class="p">,</span> <span class="n">AcAnalysis</span><span class="p">,</span> <span class="n">TransientAnalysis</span><span class="p">,</span>
                                    <span class="n">WaveForm</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PySpice.Tools.EnumFactory</span> <span class="k">import</span> <span class="n">EnumFactory</span>

<span class="c1">####################################################################################################</span>

<div class="viewcode-block" id="ffi_string_utf8"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.ffi_string_utf8">[docs]</a><span class="k">def</span> <span class="nf">ffi_string_utf8</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ffi</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span></div>

<span class="c1">####################################################################################################</span>

<div class="viewcode-block" id="Vector"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Vector">[docs]</a><span class="k">class</span> <span class="nc">Vector</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot; This class implements a vector in a simulation output.</span>

<span class="sd">    Public Attributes:</span>

<span class="sd">      :attr:`data`</span>

<span class="sd">      :attr:`name`</span>

<span class="sd">      :attr:`type`</span>
<span class="sd">        cf. `NgSpiceShared.simulation_type`</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">type_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="s1">&#39;variable: </span><span class="si">{0.name}</span><span class="s1"> </span><span class="si">{0.type}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="Vector.is_voltage_node"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Vector.is_voltage_node">[docs]</a>    <span class="k">def</span> <span class="nf">is_voltage_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">NgSpiceShared</span><span class="o">.</span><span class="n">simulation_type</span><span class="o">.</span><span class="n">voltage</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="Vector.is_branch_current"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Vector.is_branch_current">[docs]</a>    <span class="k">def</span> <span class="nf">is_branch_current</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">NgSpiceShared</span><span class="o">.</span><span class="n">simulation_type</span><span class="o">.</span><span class="n">current</span></div>

    <span class="c1">##############################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">simplified_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_branch_current</span><span class="p">():</span>
            <span class="c1"># return self.name.replace(&#39;#branch&#39;, &#39;&#39;)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="c1">##############################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">NgSpiceShared</span><span class="o">.</span><span class="n">simulation_type</span><span class="o">.</span><span class="n">voltage</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;V&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">NgSpiceShared</span><span class="o">.</span><span class="n">simulation_type</span><span class="o">.</span><span class="n">current</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">NgSpiceShared</span><span class="o">.</span><span class="n">simulation_type</span><span class="o">.</span><span class="n">time</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;s&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">NgSpiceShared</span><span class="o">.</span><span class="n">simulation_type</span><span class="o">.</span><span class="n">frequency</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Hz&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="Vector.to_waveform"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Vector.to_waveform">[docs]</a>    <span class="k">def</span> <span class="nf">to_waveform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abscissa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_real</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">to_float</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; Return a :obj:`PySpice.Probe.WaveForm` instance. &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">if</span> <span class="n">to_real</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">real</span>
        <span class="k">if</span> <span class="n">to_float</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">WaveForm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simplified_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">abscissa</span><span class="o">=</span><span class="n">abscissa</span><span class="p">)</span></div></div>

<span class="c1">####################################################################################################</span>

<div class="viewcode-block" id="Plot"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Plot">[docs]</a><span class="k">class</span> <span class="nc">Plot</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; This class implements a plot in a simulation output.</span>

<span class="sd">    Public Attributes:</span>

<span class="sd">      :attr:`plot_name`</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_name</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_name</span> <span class="o">=</span> <span class="n">plot_name</span>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="Plot.nodes"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Plot.nodes">[docs]</a>    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_float</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">abscissa</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">variable</span><span class="o">.</span><span class="n">to_waveform</span><span class="p">(</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">to_float</span><span class="o">=</span><span class="n">to_float</span><span class="p">)</span> 
                <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">is_voltage_node</span><span class="p">()]</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="Plot.branches"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Plot.branches">[docs]</a>    <span class="k">def</span> <span class="nf">branches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_float</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">abscissa</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">variable</span><span class="o">.</span><span class="n">to_waveform</span><span class="p">(</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">to_float</span><span class="o">=</span><span class="n">to_float</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">is_branch_current</span><span class="p">()]</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="Plot.elements"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Plot.elements">[docs]</a>    <span class="k">def</span> <span class="nf">elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abscissa</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">variable</span><span class="o">.</span><span class="n">to_waveform</span><span class="p">(</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">to_float</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
                <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="Plot.to_analysis"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.Plot.to_analysis">[docs]</a>    <span class="k">def</span> <span class="nf">to_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;op&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_operating_point_analysis</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;sens&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_sensitivity_analysis</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dc&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dc_analysis</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ac&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_ac_analysis</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;tran&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_transient_analysis</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Unsupported plot name </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_name</span><span class="p">))</span></div>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_to_operating_point_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="n">OperatingPoint</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">to_float</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">branches</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">(</span><span class="n">to_float</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_to_sensitivity_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Fixme: separate v(vinput), analysis.R2.m</span>
        <span class="k">return</span> <span class="n">SensitivityAnalysis</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">())</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_to_dc_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="s1">&#39;v(v-sweep)&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">sweep_variable</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;v(v-sweep)&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s1">&#39;v(i-sweep)&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">sweep_variable</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;v(i-sweep)&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="n">sweep</span> <span class="o">=</span> <span class="n">sweep_variable</span><span class="o">.</span><span class="n">to_waveform</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">DcAnalysis</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">branches</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">())</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_to_ac_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_waveform</span><span class="p">(</span><span class="n">to_real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AcAnalysis</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">branches</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">())</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_to_transient_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_waveform</span><span class="p">(</span><span class="n">to_real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">TransientAnalysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">abscissa</span><span class="o">=</span><span class="n">time</span><span class="p">),</span> <span class="n">branches</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">(</span><span class="n">abscissa</span><span class="o">=</span><span class="n">time</span><span class="p">))</span></div>

<span class="c1">####################################################################################################</span>

<div class="viewcode-block" id="NgSpiceShared"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared">[docs]</a><span class="k">class</span> <span class="nc">NgSpiceShared</span><span class="p">:</span>

    <span class="n">_logger</span> <span class="o">=</span> <span class="n">_module_logger</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="s1">&#39;NgSpiceShared&#39;</span><span class="p">)</span>

    <span class="n">simulation_type</span> <span class="o">=</span> <span class="n">EnumFactory</span><span class="p">(</span><span class="s1">&#39;SimulationType&#39;</span><span class="p">,</span> <span class="p">(</span>
        <span class="s1">&#39;no_type&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">,</span>
        <span class="s1">&#39;frequency&#39;</span><span class="p">,</span>
        <span class="s1">&#39;voltage&#39;</span><span class="p">,</span>
        <span class="s1">&#39;current&#39;</span><span class="p">,</span>
        <span class="s1">&#39;output_noise_density&#39;</span><span class="p">,</span>
        <span class="s1">&#39;output_noise&#39;</span><span class="p">,</span>
        <span class="s1">&#39;input_noise_density&#39;</span><span class="p">,</span>
        <span class="s1">&#39;input_noise&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pole&#39;</span><span class="p">,</span>
        <span class="s1">&#39;zero&#39;</span><span class="p">,</span>
        <span class="s1">&#39;s_parameter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;res&#39;</span><span class="p">,</span>
        <span class="s1">&#39;impedance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;admittance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;power&#39;</span><span class="p">,</span>
        <span class="s1">&#39;phase&#39;</span><span class="p">,</span>
        <span class="s1">&#39;db&#39;</span><span class="p">,</span>
        <span class="s1">&#39;capacitance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;charge&#39;</span><span class="p">))</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">send_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; Set the *send_data* flag if you want to enable the output callback.</span>

<span class="sd">        Set the *ngspice_id* to an integer value if you want to run NgSpice in parallel.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_id</span> <span class="o">=</span> <span class="n">ngspice_id</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_load_library</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_ngspice</span><span class="p">(</span><span class="n">send_data</span><span class="p">)</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_load_library</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">api_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;api.h&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">api_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">ffi</span><span class="o">.</span><span class="n">cdef</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_id</span><span class="p">:</span>
            <span class="n">library_prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">library_prefix</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_id</span><span class="p">)</span>
        <span class="n">library_file</span> <span class="o">=</span> <span class="s1">&#39;libngspice</span><span class="si">{}</span><span class="s1">.so&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">library_prefix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">dlopen</span><span class="p">(</span><span class="n">library_file</span><span class="p">)</span>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_init_ngspice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">send_data</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_send_char_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s1">&#39;int (char *, int, void *)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_char</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_stat_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s1">&#39;int (char *, int, void *)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_stat</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exit_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s1">&#39;int (int, bool, bool, int, void *)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_init_data_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s1">&#39;int (pvecinfoall, int, void *)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_init_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">send_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_data_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s1">&#39;int (pvecvaluesall, int, int, void *)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_data_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">NULL</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_vsrc_data_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s1">&#39;int (double *, double, char *, int, void *)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vsrc_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_isrc_data_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s1">&#39;int (double *, double, char *, int, void *)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_isrc_data</span><span class="p">)</span>

        <span class="n">self_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">new_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_self_c</span> <span class="o">=</span> <span class="n">self_c</span> <span class="c1"># To prevent garbage collection</span>

        <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngSpice_Init</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_send_char_c</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_send_stat_c</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_exit_c</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_send_data_c</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">_send_init_data_c</span><span class="p">,</span>
                                               <span class="n">ffi</span><span class="o">.</span><span class="n">NULL</span><span class="p">,</span> <span class="c1"># BGThreadRunning</span>
                                               <span class="n">self_c</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Ngspice_Init returned </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rc</span><span class="p">))</span>

        <span class="n">ngspice_id_c</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;int *&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_id</span> <span class="o">=</span> <span class="n">ngspice_id_c</span> <span class="c1"># To prevent garbage collection</span>
        <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngSpice_Init_Sync</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_vsrc_data_c</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">_get_isrc_data_c</span><span class="p">,</span>
                                                    <span class="n">ffi</span><span class="o">.</span><span class="n">NULL</span><span class="p">,</span> <span class="c1"># GetSyncData</span>
                                                    <span class="n">ngspice_id_c</span><span class="p">,</span>
                                                    <span class="n">self_c</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Ngspice_Init_Sync returned </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rc</span><span class="p">))</span>

    <span class="c1">##############################################</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_send_char</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;FFI Callback&quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_char</span><span class="p">(</span><span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">ngspice_id</span><span class="p">)</span>

    <span class="c1">##############################################</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_send_stat</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;FFI Callback&quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_stat</span><span class="p">(</span><span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">ngspice_id</span><span class="p">)</span>

    <span class="c1">##############################################</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_exit</span><span class="p">(</span><span class="n">exit_status</span><span class="p">,</span> <span class="n">immediate_unloding</span><span class="p">,</span> <span class="n">quit_exit</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;FFI Callback&quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ngspice_id-</span><span class="si">{}</span><span class="s1"> exit </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngspice_id</span><span class="p">,</span>
                                                                   <span class="n">exit_status</span><span class="p">,</span>
                                                                   <span class="n">immediate_unloding</span><span class="p">,</span>
                                                                   <span class="n">quit_exit</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">exit_status</span>

    <span class="c1">##############################################</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_send_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">number_of_vectors</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;FFI Callback&quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ngspice_id-</span><span class="si">{}</span><span class="s1"> send_data [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngspice_id</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">vecindex</span><span class="p">))</span>
        <span class="n">actual_vector_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">number_of_vectors</span><span class="p">)):</span>
            <span class="n">actual_vector_value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">vecsa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">vector_name</span> <span class="o">=</span> <span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">actual_vector_value</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">actual_vector_value</span><span class="o">.</span><span class="n">creal</span><span class="p">,</span> <span class="n">actual_vector_value</span><span class="o">.</span><span class="n">cimag</span><span class="p">)</span>
            <span class="n">actual_vector_values</span><span class="p">[</span><span class="n">vector_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;    Vector: </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vector_name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_data</span><span class="p">(</span><span class="n">actual_vector_values</span><span class="p">,</span> <span class="n">number_of_vectors</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">)</span>

    <span class="c1">##############################################</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_send_init_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>  <span class="n">ngspice_id</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;FFI Callback&quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ngspice_id-</span><span class="si">{}</span><span class="s1"> send_init_data&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngspice_id</span><span class="p">))</span>
            <span class="n">number_of_vectors</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">veccount</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_vectors</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;  Vector: &#39;</span> <span class="o">+</span> <span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vecname</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_init_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">)</span> <span class="c1"># Fixme: should be a Python object</span>

    <span class="c1">##############################################</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_vsrc_data</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;FFI Callback&quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vsrc_data</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> <span class="n">ngspice_id</span><span class="p">)</span>

    <span class="c1">##############################################</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_isrc_data</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;FFI Callback&quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">user_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_isrc_data</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> <span class="n">ngspice_id</span><span class="p">)</span>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.send_char"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.send_char">[docs]</a>    <span class="k">def</span> <span class="nf">send_char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reimplement this callback in a subclass to process logging messages from the simulator. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ngspice-</span><span class="si">{}</span><span class="s1"> send_char </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngspice_id</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.send_stat"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.send_stat">[docs]</a>    <span class="k">def</span> <span class="nf">send_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reimplement this callback in a subclass to process statistic messages from the simulator. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ngspice-</span><span class="si">{}</span><span class="s1"> send_stat </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngspice_id</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.send_data"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.send_data">[docs]</a>    <span class="k">def</span> <span class="nf">send_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actual_vector_values</span><span class="p">,</span> <span class="n">number_of_vectors</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reimplement this callback in a subclass to process the vector actual values. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.send_init_data"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.send_init_data">[docs]</a>    <span class="k">def</span> <span class="nf">send_init_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>  <span class="n">ngspice_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reimplement this callback in a subclass to process the initial data. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.get_vsrc_data"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.get_vsrc_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_vsrc_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">voltage</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reimplement this callback in a subclass to provide external voltage source. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ngspice_id-</span><span class="si">{}</span><span class="s1"> get_vsrc_data @</span><span class="si">{}</span><span class="s1"> node </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngspice_id</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.get_isrc_data"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.get_isrc_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_isrc_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">ngspice_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reimplement this callback in a subclass to provide external current source. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ngspice_id-</span><span class="si">{}</span><span class="s1"> get_isrc_data @</span><span class="si">{}</span><span class="s1"> node </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngspice_id</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.load_circuit"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.load_circuit">[docs]</a>    <span class="k">def</span> <span class="nf">load_circuit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">circuit</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; Load the given circuit string. &quot;&quot;&quot;</span>

        <span class="n">circuit_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="p">]</span>
        <span class="n">circuit_lines_keepalive</span> <span class="o">=</span> <span class="p">[</span><span class="n">ffi</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;char[]&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">))</span>
                                   <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">circuit_lines</span><span class="p">]</span>
        <span class="n">circuit_lines_keepalive</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ffi</span><span class="o">.</span><span class="n">NULL</span><span class="p">]</span>
        <span class="n">circuit_array</span> <span class="o">=</span> <span class="n">ffi</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;char *[]&quot;</span><span class="p">,</span> <span class="n">circuit_lines_keepalive</span><span class="p">)</span>
        <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngSpice_Circ</span><span class="p">(</span><span class="n">circuit_array</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;ngSpice_Circ returned </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rc</span><span class="p">))</span></div>

        <span class="c1"># for line in circuit_lines:</span>
        <span class="c1">#     rc = self._ngspice_shared.ngSpice_Command(&#39;circbyline &#39; + line)</span>
        <span class="c1">#     if rc:</span>
        <span class="c1">#         raise NameError(&quot;ngSpice_Command circbyline returned {}&quot;.format(rc))</span>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.run"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; Run the simulation in the background thread and wait until the simulation is done. &quot;&quot;&quot;</span>

        <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngSpice_Command</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;bg_run&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;ngSpice_Command bg_run returned </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rc</span><span class="p">))</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># required before to test if the simulation is running</span>
        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngSpice_running</span><span class="p">()):</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Simulation is done&quot;</span><span class="p">)</span></div>

    <span class="c1">##############################################</span>

    <span class="k">def</span> <span class="nf">_convert_string_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>

        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">ffi</span><span class="o">.</span><span class="n">NULL</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">strings</span>

    <span class="c1">##############################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">plot_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; Return the list of plot names. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_string_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngSpice_AllPlots</span><span class="p">())</span>

    <span class="c1">##############################################</span>

<div class="viewcode-block" id="NgSpiceShared.plot"><a class="viewcode-back" href="../../../../api/PySpice/Spice/NgSpice/Shared.html#PySpice.Spice.NgSpice.Shared.NgSpiceShared.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_name</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; Return the corresponding plot. &quot;&quot;&quot;</span>

        <span class="n">plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">plot_name</span><span class="p">)</span>
        <span class="n">all_vectors_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngSpice_AllVecs</span><span class="p">(</span><span class="n">plot_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">all_vectors_c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">ffi</span><span class="o">.</span><span class="n">NULL</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vector_name</span> <span class="o">=</span> <span class="n">ffi_string_utf8</span><span class="p">(</span><span class="n">all_vectors_c</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">plot_name</span><span class="p">,</span> <span class="n">vector_name</span><span class="p">))</span>
                <span class="n">vector_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngspice_shared</span><span class="o">.</span><span class="n">ngGet_Vec_Info</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">))</span>
                <span class="n">vector_type</span> <span class="o">=</span> <span class="n">vector_info</span><span class="o">.</span><span class="n">v_type</span>
                <span class="n">length</span> <span class="o">=</span> <span class="n">vector_info</span><span class="o">.</span><span class="n">v_length</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;vector[</span><span class="si">{}</span><span class="s2">] </span><span class="si">{}</span><span class="s2"> type </span><span class="si">{}</span><span class="s2"> flags </span><span class="si">{}</span><span class="s2"> length </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span>
                                                                                     <span class="n">vector_name</span><span class="p">,</span>
                                                                                     <span class="n">vector_type</span><span class="p">,</span>
                                                                                     <span class="n">vector_info</span><span class="o">.</span><span class="n">v_flags</span><span class="p">,</span>
                                                                                     <span class="n">length</span><span class="p">))</span>
                <span class="c1"># flags: VF_REAL = 1 &lt;&lt; 0, VF_COMPLEX = 1 &lt;&lt; 1</span>
                <span class="k">if</span> <span class="n">vector_info</span><span class="o">.</span><span class="n">v_compdata</span> <span class="o">==</span> <span class="n">ffi</span><span class="o">.</span><span class="n">NULL</span><span class="p">:</span>
                    <span class="c1"># for k in xrange(length):</span>
                    <span class="c1">#     print(&quot;  [{}] {}&quot;.format(k, vector_info.v_realdata[k]))</span>
                    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">ffi</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">vector_info</span><span class="o">.</span><span class="n">v_realdata</span><span class="p">,</span> <span class="n">length</span><span class="o">*</span><span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># for k in xrange(length):</span>
                    <span class="c1">#     value = vector_info.v_compdata[k]</span>
                    <span class="c1">#     print(ffi.addressof(value, field=&#39;cx_real&#39;), ffi.addressof(value, field=&#39;cx_imag&#39;))</span>
                    <span class="c1">#     print(&quot;  [{}] {} + i {}&quot;.format(k, value.cx_real, value.cx_imag))</span>
                    <span class="n">tmp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">ffi</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">vector_info</span><span class="o">.</span><span class="n">v_compdata</span><span class="p">,</span> <span class="n">length</span><span class="o">*</span><span class="mi">8</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
                    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tmp_array</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
                    <span class="n">array</span><span class="o">.</span><span class="n">imag</span> <span class="o">=</span> <span class="n">tmp_array</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">plot</span><span class="p">[</span><span class="n">vector_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">vector_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_type</span><span class="p">[</span><span class="n">vector_type</span><span class="p">],</span> <span class="n">array</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">plot</span></div></div>

<span class="c1">####################################################################################################</span>
<span class="c1">#</span>
<span class="c1"># End</span>
<span class="c1">#</span>
<span class="c1">####################################################################################################</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">PySpice 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../Spice.html" >PySpice.Spice</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Fabrice Salvaire.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>